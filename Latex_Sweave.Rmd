---
title: "Cours Latex/Sweave"
author: "Ludovic Chaumaz / Maxime Jaunatre"
date: "19 septembre 2019"
output: ioslides_presentation
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(# include = FALSE, # don't evaluate code chunk
                      eval = FALSE, # don't run code
                      echo = FALSE, # hide code
                      message = FALSE, # hide message provoked by code
                      warning = FALSE, # idem but for warningss
                      fig.cap = "...") # don't know what it does
```

<!--Ludovic & latex -->

## Qu'est ce que c'est ?

Système de composition de document

MiKTeX pour Windows / TeX Live pour Linux et Mac

Ex : 
```{r, echo = T}
\documentclass{article}


\begin{document}

Bonjour

\end{document}
```

va créer un fichier avec écrit "Bonjour".

## Packages

Ne peut pas faire grand chose par défaut.

De nombreux packages permettent de nombreuses fonctionnalités.

## Quelques fonctionnalités utiles

Structure des documents :

Différentes fonctions pour différents éléments de structure.

Ex :
```{r, echo = T}
\part     # pour une partie
\chapter     # pour un chapitre
\section     # pour une section
\paragraph     # pour un paragraphe
```

Etc...

## Quelques fonctionnalités utiles

Style du texte :

```{r, echo = T}
\textbf{Bonjour}     # écrit "Bonjour" en gras
\textit{Bonjour}     # écrit "Bonjour" en italique
\textul{Bonjour}     # écrit "Bonjour" souligné
\textcolor{red}{Bonjour}     # écrit "Bonjour" en rouge
```

Etc...

## Ajouter des éléments

Ajouter une image :

```{r, echo = T}
\includegraphics{image.png}
```

Ajouter un tableau :

```{r, echo = T}
\begin{tabular}{|c|c|}
\hline
1 & 2 \\
\hline
3 & 4 \\
\hline
\end{tabular}
```

Très pratique pour ajouter des équations ! Existe des fonctions pour fractions, racines carrées...

## Ajouter un autre fichier Tex

```{r, echo = T}
\input{nom_du_fichier}
```

Très pratique pour réutiliser un Template déjà créé !

## Table des matières

Avec le découpage vu précédemment, une ligne de code suffit à créer une table des matières !!!

```{r, echo = T}
\tableofcontents
```

## Bibliographie

```{r, echo = T}
@article{nom_de_la_ref1,
champ1 ={},
champ2 ={}
}

@misc{nom_de_la_ref1,
champ1 ={},
champ2 ={}
}


\begin{document}

Je pose la ref ici \cite{nom_de_la_ref}

\bibliographystyle{}

\end{document}
```

<!--Maxime & sweave-->

## Incorporer du code R

Rstudio incorpore le systeme de fichiers Rsweave pour faire du latex via la syntaxe `noweb`.

Pour faire simple, le markdown est un Rsweave simplifié.

Les chunks ont des balises différentes :

markdown :
```
#```{r nom_du_chunk ,include = FALSE, eval = FALSE, echo = FALSE, message = FALSE, warning = FALSE}
#  #code here
# ```
```
sweave :
```
#<< label = label_du_chunk, option = value >>=
# #code here
#@
```

## Options des chunks

Par défaut, premier mot du chunk est son label.

Plusieurs chunks peuvent avoir le même label. 

L'absence de label leur attribue un numero.

*option des chunks  : TRUE, true, T ou FALSE, false, F*

| option   |      meaning     |  default |
|:--------:|:-------------:|:------:|
| echo |  indique si le code doit apparaître ou non | TRUE |
| eval |    indique si le code doit être exécuté ou non.   |   TRUE |
| fig | indique si la figure doit être générée ou non. |    FALSE |
| pdf | indique si un pdf de la figure doit être généré ou non. |   FALSE |
| ref.label | rappelle un chunk pour le reproduire (avec le nom du chunk en value) |   FALSE |

## Utilisation des chunks

Les informations sont 'stockés' par chunk et peuvent être rappelées

```
<<first>>=
 x <- 3
@
```

```
<<second>>=
 y <- <<first>>^2
@
```

Et incorporées dans le text avec `\Sexpr{y}`

<!--notes diverses 
## Incorporer du code R
prefix.string > label > number

figures can be exported in a special directory if global sweave option says so...notion of compedium

can include files in tex, but won't process them , with `\imput` 
`\SweaveInput{}` process them or not?

`\Sexpr{expr}` add values in text or even code. But need to remove all braces

can put reference to chunks with `<<name>>`

This is `noweb` synthax but in fact there is a multitude of them

encoding is ASCII by default, but can't be greatly modified (see fontenc and inputenc)
encoding seem's tricky, to look further

default figure scale is `\setkeys{Gin}{width=0.8\textwidth}`
to modify it, insert same code afet `\begin{document}`

new  file is generated for each figure, so par() are to reset each time
need to create a function to set it as default, might be tricky as well

default figure output is pdf, can be change by  `<<figN, fig=TRUE, pdf=FALSE, png=TRUE>>`

Rtangle extract all code and form a .R apart (like maya did) (so there is no need to split = T)

ONLY ONE GRAPH PER CHUNK !  SO NO FOR LOOP FOR FIGURES
a way to hack it :
```
<<results=tex,echo=FALSE>>=
for(i in 1:4){
  fname <- paste("myfile", i, ".pdf", sep = "")
  pdf(file = fname, width = 6, height = 6)
  plot(rnorm(100)+i)
  dev.off()
  cat("\\includegraphics{", fname, "}\n\n", sep = "")
}
@
```

## Incorporer du code R
set line length in R :
`{r} options(width = 40)`
-->

## Références et aides

Lien vers la vignette Sweave :  <http://127.0.0.1:24054/library/utils/doc/Sweave.pdf>.

aide des options de chunks sweaves :
```{r, echo = T}
help(RweaveLatex)
```

Au final : `RTFM`

```{r exemple, include = FALSE, eval = FALSE, echo = FALSE, message = FALSE, warning = FALSE}
print('hello world !')
# include : don't evaluate code chunk
# eval : don't run the code
# echo : hide code
# message : hide message provoked by code
# warning : idem but for warningss
```






